import{h as C,d as z,a as b,o as c,c as l,b as t,e as m,f as y,u as a,j as T,t as p,w as A,v as D,i as M,F as x,r as E,g as v}from"./index-4UUoQKv_.js";import{P as K}from"./PaginationWeb-JKP-R-Rx.js";const{$axios:w,$qs:R,showErrorMsg:yt}=C(),g=z({id:"subCategory",state:()=>({items:[],item:"",filter:{search:""},pagination:{page:1,lastPage:0,last_page:0,perPage:0,total:0,total_current:0}}),getters:{getItems:e=>e.items,getItem:e=>e.item,getPagination:e=>e.pagination,getFilter:e=>e.filter},actions:{async fetchItems(e={},o="sub-categories"){try{const s=await w({method:"get",url:o+"?"+R.stringify(e),headers:{Authorization:`Bearer ${b().token}`}});return this.items=s.data.data.data,delete e.page,this.setFilter(e),this.setPagination(s.data.data),s}catch{return Promise.reject(!1)}},async fetchItem(e,o="ctv"){try{const s=await w({method:"get",url:o+`/${e}/subCategory`,headers:{"Content-Type":"application/json",Authorization:`Bearer ${b().token}`}});return this.item=s.data.data,s}catch{return Promise.reject(!1)}},async removeItem(e,o="sub-categories"){try{const s=await w({method:"delete",url:o+`/${e}`,headers:{"Content-Type":"application/json",Authorization:`Bearer ${b().token}`}});return this.items=this.items.filter(d=>d.id!==e),s}catch{return Promise.reject(!1)}},setPagination(e){delete e.data,this.pagination={...e,page:e.page}},setFilter(e){for(var o in this.filter)this.filter[o]=e[o]}}}),H={class:"page-breadcrumb"},U={class:"row"},W={class:"col-12 d-flex no-block align-items-center"},G={class:"page-title"},J=t("i",{class:"fa fa-chevron-left","aria-hidden":"true"},null,-1),O={class:"container-fluid"},Q={class:"row"},X={class:"col-12"},Y={class:"card"},Z={class:"form-group"},tt={class:"card-body"},et=t("h5",{class:"card-title mb-0"},null,-1),at=t("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1),st={class:"table-responsive"},ot={class:"table"},nt=t("thead",null,[t("tr",null,[t("th",{scope:"col"},[t("b",null,"Tên")]),t("th",{scope:"col"},[t("b",null,"Thời gian nhập")]),t("th",{scope:"col"},[t("b",null,"Thời gian cập nhật")]),t("th",{scope:"col"})])],-1),rt={scope:"row"},it={key:0},ct={key:0},lt=t("i",{class:"fas fa-edit text-warning"},null,-1),dt=["onClick"],ht=t("i",{class:"fa fa-trash text-danger","aria-hidden":"true"},null,-1),ut=[ht],_t={key:0},mt=t("td",{class:"text-center",colspan:"5"},"Không tìm thấy dữ liệu",-1),pt=[mt],vt={__name:"ListView",setup(e){const{computed:o,RouterLink:s,ref:d,debounce:I,showSuccessMsg:S,confirmPopup:$,dateTimeFormat:k,route:j}=C(),{fetchItems:B,removeItem:F}=g(),f=d({category_id:j.params.id}),h=(_,i)=>{B({page:_,...i,...f.value})},V=_=>{$().then(()=>{F(_.id).then(i=>{S(i.data.data)})})},r=d("");h(1);const u=o(()=>g().getPagination),P=o(()=>I(L,200)),L=()=>{r.value.trim()!==""?setTimeout(()=>{h(1,{name:r.value})},500):h(1)},N=()=>r.value?{name:r.value}:{};return(_,i)=>(c(),l(x,null,[t("div",H,[t("div",U,[t("div",W,[t("h4",G,[m(a(s),{class:"btn btn-primary",to:{name:"web-category"}},{default:y(()=>[J]),_:1}),T(" Danh mục con của "+p((a(u)&&a(u).item?a(u).item.name:"").toLowerCase()),1)])])])]),t("div",O,[t("div",Q,[t("div",X,[t("div",Y,[t("div",Z,[A(t("input",{type:"text",class:"form-control border-dark",placeholder:"Tìm kiếm (Tên danh mục con)","onUpdate:modelValue":i[0]||(i[0]=n=>M(r)?r.value=n:null),onKeyup:i[1]||(i[1]=(...n)=>a(P)&&a(P)(...n))},null,544),[[D,a(r)]])]),t("div",tt,[et,m(a(s),{class:"btn btn-primary",to:{name:"web-edit-sub-category",query:N(),params:{...a(f)}}},{default:y(()=>[at,T(" Thêm mới")]),_:1},8,["to"])]),t("div",st,[t("table",ot,[nt,t("tbody",null,[(c(!0),l(x,null,E(a(g)().getItems,(n,q)=>(c(),l("tr",{key:q},[t("td",rt,p(n.name),1),t("td",null,[n.created_at?(c(),l("span",it,p(a(k)(n.created_at)),1)):v("",!0)]),t("td",null,[n.updated_at?(c(),l("span",ct,p(a(k)(n.updated_at)),1)):v("",!0)]),t("td",null,[t("div",null,[m(a(s),{class:"btn",to:{name:"web-edit-sub-category",params:{id:n.id,...a(f)}}},{default:y(()=>[lt]),_:2},1032,["to"]),t("button",{onClick:gt=>V(n),class:"btn"},ut,8,dt)])])]))),128)),!a(g)().getItems.length&&a(r)!=""?(c(),l("tr",_t,pt)):v("",!0)])])]),m(K,{onHandlePage:h,pagination1:a(u)},null,8,["pagination1"])])])])])],64))}};export{vt as default};
